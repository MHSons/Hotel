<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Departments | AlphaMed</title><style>body{font-family:Arial,Helvetica,sans-serif;margin:0;background:linear-gradient(135deg,#1e3a8a,#2563eb);min-height:100vh} .container{max-width:1100px;margin:40px auto;background:#fff;padding:25px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.2)} input,select{padding:8px;border-radius:6px;border:1px solid #ccc} button{background:#2563eb;color:#fff;padding:6px 10px;border:none;border-radius:6px;cursor:pointer} .btn-del{background:#ef4444} table{width:100%;border-collapse:collapse;margin-top:15px} th,td{padding:8px;border-bottom:1px solid #eee} th{background:#f3f4f6;color:#1e3a8a} .back{text-align:center;margin-top:15px;display:block;color:#2563eb;text-decoration:none}</style></head><body><div class="container"><h2 style="text-align:center;color:#1e3a8a">Departments & Tests Management</h2><div style="margin-bottom:12px"><input id="deptName" placeholder="Department Name" style="padding:8px;border-radius:6px;border:1px solid #ccc;width:60%"><button onclick="addDepartment()">Add Department</button></div><div style="margin-bottom:12px"><select id="deptSelect" style="padding:8px;border-radius:6px;border:1px solid #ccc;width:40%"></select><input id="testName" placeholder="Test Name" style="padding:8px;border-radius:6px;border:1px solid #ccc;width:30%"><input id="unit" placeholder="Unit" style="padding:8px;border-radius:6px;border:1px solid #ccc;width:10%"><input id="minValue" placeholder="Min" type="number" style="padding:8px;border-radius:6px;border:1px solid #ccc;width:8%"><input id="maxValue" placeholder="Max" type="number" style="padding:8px;border-radius:6px;border:1px solid #ccc;width:8%"><input id="normalRange" placeholder="Normal Range" style="padding:8px;border-radius:6px;border:1px solid #ccc;width:40%"><button onclick="addTest()">Add Test</button></div><table><thead><tr><th>Department</th><th>Tests Count</th><th>Actions</th></tr></thead><tbody id="deptTable"></tbody></table><a class="back" href="dashboard.html">← Back to Dashboard</a></div><script>const user=JSON.parse(localStorage.getItem('loggedUser')||'null'); if(!user){alert('Please login');window.location='index.html'} if(user.role!=='admin'){alert('Only admin');window.location='dashboard.html'} function loadDepartments(){ const d=JSON.parse(localStorage.getItem('departments')||'[]'); const sel=document.getElementById('deptSelect'); sel.innerHTML='<option value="">Select Department</option>'; d.forEach(x=>sel.innerHTML+='<option>'+x.name+'</option>'); const tbody=document.getElementById('deptTable'); tbody.innerHTML=''; d.forEach((x,i)=>{ const tests=JSON.parse(localStorage.getItem('tests')||'[]').filter(t=>t.department===x.name); const tr=document.createElement('tr'); tr.innerHTML=`<td>${x.name}</td><td>${tests.length}</td><td><button onclick="viewTests('${x.name}')">View</button> <button class="btn-del" onclick="deleteDept(${i})">Delete</button></td>`; tbody.appendChild(tr); }); } function addDepartment(){ const name=document.getElementById('deptName').value.trim(); if(!name)return alert('Enter name'); let d=JSON.parse(localStorage.getItem('departments')||'[]'); if(d.some(x=>x.name.toLowerCase()===name.toLowerCase())) return alert('Exists'); d.push({name}); localStorage.setItem('departments',JSON.stringify(d)); document.getElementById('deptName').value=''; loadDepartments() } function deleteDept(i){ if(!confirm('Delete dept?')) return; let d=JSON.parse(localStorage.getItem('departments')||'[]'); const nm=d[i].name; d.splice(i,1); localStorage.setItem('departments',JSON.stringify(d)); let tests=JSON.parse(localStorage.getItem('tests')||'[]'); tests=tests.filter(t=>t.department!==nm); localStorage.setItem('tests',JSON.stringify(tests)); loadDepartments() } function addTest(){ const dept=document.getElementById('deptSelect').value; const tn=document.getElementById('testName').value.trim(); const unit=document.getElementById('unit').value.trim(); const min=parseFloat(document.getElementById('minValue').value); const max=parseFloat(document.getElementById('maxValue').value); const normal=document.getElementById('normalRange').value.trim(); if(!dept||!tn||isNaN(min)||isNaN(max)) return alert('Fill fields'); let tests=JSON.parse(localStorage.getItem('tests')||'[]'); tests.push({department:dept,test_name:tn,unit:unit,min_value:min,max_value:max,normal_range_adult:normal}); localStorage.setItem('tests',JSON.stringify(tests)); alert('Test added'); document.getElementById('testName').value=''; document.getElementById('unit').value=''; document.getElementById('minValue').value=''; document.getElementById('maxValue').value=''; document.getElementById('normalRange').value=''; loadDepartments() } function viewTests(nm){ const t=JSON.parse(localStorage.getItem('tests')||'[]').filter(x=>x.department===nm); if(t.length===0) return alert('No tests'); let s='Tests in '+nm+':\n\n'; t.forEach(x=> s+=x.test_name+' ('+x.unit+') → '+x.normal_range_adult+'\n'); alert(s) } loadDepartments();</script><script src="app.js"></script></body></html>
